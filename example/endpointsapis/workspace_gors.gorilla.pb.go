// Code generated by protoc-gen-gors-gorilla. DO NOT EDIT.

package endpointsapis

import (
	context "context"
	fmt "fmt"
	jsonx "github.com/go-leo/gox/encodingx/jsonx"
	errorx "github.com/go-leo/gox/errorx"
	urlx "github.com/go-leo/gox/netx/urlx"
	mux "github.com/gorilla/mux"
	protojson "google.golang.org/protobuf/encoding/protojson"
	emptypb "google.golang.org/protobuf/types/known/emptypb"
	http "net/http"
)

type WorkspacesGorillaService interface {
	ListWorkspaces(ctx context.Context, request *ListWorkspacesRequest) (*ListWorkspacesResponse, error)
	GetWorkspace(ctx context.Context, request *GetWorkspaceRequest) (*Workspace, error)
	CreateWorkspace(ctx context.Context, request *CreateWorkspaceRequest) (*Workspace, error)
	UpdateWorkspace(ctx context.Context, request *UpdateWorkspaceRequest) (*Workspace, error)
	DeleteWorkspace(ctx context.Context, request *DeleteWorkspaceRequest) (*emptypb.Empty, error)
}

func AppendWorkspacesGorillaRoute(router *mux.Router, svc WorkspacesGorillaService) *mux.Router {
	transports := newWorkspacesGorillaTransports(svc)
	router.NewRoute().Name("/google.example.endpointsapis.v1.Workspaces/ListWorkspaces").
		Methods("GET").
		Path("/v1/projects/{project}/locations/{location}/workspaces").
		Handler(transports.ListWorkspaces())
	router.NewRoute().Name("/google.example.endpointsapis.v1.Workspaces/GetWorkspace").
		Methods("GET").
		Path("/v1/projects/{project}/locations/{location}/workspaces/{workspac}").
		Handler(transports.GetWorkspace())
	router.NewRoute().Name("/google.example.endpointsapis.v1.Workspaces/CreateWorkspace").
		Methods("POST").
		Path("/v1/projects/{project}/locations/{location}/workspaces").
		Handler(transports.CreateWorkspace())
	router.NewRoute().Name("/google.example.endpointsapis.v1.Workspaces/UpdateWorkspace").
		Methods("PATCH").
		Path("/v1/projects/{project}/locations/{location}/Workspaces/{Workspac}").
		Handler(transports.UpdateWorkspace())
	router.NewRoute().Name("/google.example.endpointsapis.v1.Workspaces/DeleteWorkspace").
		Methods("DELETE").
		Path("/v1/projects/{project}/locations/{location}/workspaces/{workspac}").
		Handler(transports.DeleteWorkspace())
	return router
}

type WorkspacesGorillaTransports struct {
	svc     WorkspacesGorillaService
	decoder *WorkspacesGorillaRequestDecoder
	encoder *WorkspacesGorillaResponseEncoder
}

func (t *WorkspacesGorillaTransports) ListWorkspaces() http.Handler {
	return http.HandlerFunc(func(writer http.ResponseWriter, request *http.Request) {
		ctx := request.Context()
		in, err := t.decoder.ListWorkspaces(ctx, request)
		if err != nil {
			return
		}
		out, err := t.svc.ListWorkspaces(ctx, in)
		if err != nil {
			return
		}
		if err := t.encoder.ListWorkspaces(ctx, writer, out); err != nil {
			return
		}
	})
}

func (t *WorkspacesGorillaTransports) GetWorkspace() http.Handler {
	return http.HandlerFunc(func(writer http.ResponseWriter, request *http.Request) {
		ctx := request.Context()
		in, err := t.decoder.GetWorkspace(ctx, request)
		if err != nil {
			return
		}
		out, err := t.svc.GetWorkspace(ctx, in)
		if err != nil {
			return
		}
		if err := t.encoder.GetWorkspace(ctx, writer, out); err != nil {
			return
		}
	})
}

func (t *WorkspacesGorillaTransports) CreateWorkspace() http.Handler {
	return http.HandlerFunc(func(writer http.ResponseWriter, request *http.Request) {
		ctx := request.Context()
		in, err := t.decoder.CreateWorkspace(ctx, request)
		if err != nil {
			return
		}
		out, err := t.svc.CreateWorkspace(ctx, in)
		if err != nil {
			return
		}
		if err := t.encoder.CreateWorkspace(ctx, writer, out); err != nil {
			return
		}
	})
}

func (t *WorkspacesGorillaTransports) UpdateWorkspace() http.Handler {
	return http.HandlerFunc(func(writer http.ResponseWriter, request *http.Request) {
		ctx := request.Context()
		in, err := t.decoder.UpdateWorkspace(ctx, request)
		if err != nil {
			return
		}
		out, err := t.svc.UpdateWorkspace(ctx, in)
		if err != nil {
			return
		}
		if err := t.encoder.UpdateWorkspace(ctx, writer, out); err != nil {
			return
		}
	})
}

func (t *WorkspacesGorillaTransports) DeleteWorkspace() http.Handler {
	return http.HandlerFunc(func(writer http.ResponseWriter, request *http.Request) {
		ctx := request.Context()
		in, err := t.decoder.DeleteWorkspace(ctx, request)
		if err != nil {
			return
		}
		out, err := t.svc.DeleteWorkspace(ctx, in)
		if err != nil {
			return
		}
		if err := t.encoder.DeleteWorkspace(ctx, writer, out); err != nil {
			return
		}
	})
}

func newWorkspacesGorillaTransports(svc WorkspacesGorillaService) *WorkspacesGorillaTransports {
	return &WorkspacesGorillaTransports{
		svc:     svc,
		decoder: &WorkspacesGorillaRequestDecoder{},
		encoder: &WorkspacesGorillaResponseEncoder{},
	}
}

type WorkspacesGorillaRequestDecoder struct {
}

func (*WorkspacesGorillaRequestDecoder) ListWorkspaces(ctx context.Context, r *http.Request) (*ListWorkspacesRequest, error) {
	req := &ListWorkspacesRequest{}
	vars := urlx.FormFromMap(mux.Vars(r))
	var varErr error
	req.Parent = fmt.Sprintf("projects/%s/locations/%s", vars.Get("project"), vars.Get("location"))
	if varErr != nil {
		return nil, varErr
	}
	queries := r.URL.Query()
	var queryErr error
	req.PageSize, queryErr = errorx.Break[int32](queryErr)(urlx.GetInt[int32](queries, "page_size"))
	req.PageToken = queries.Get("page_token")
	if queryErr != nil {
		return nil, queryErr
	}
	return req, nil
}
func (*WorkspacesGorillaRequestDecoder) GetWorkspace(ctx context.Context, r *http.Request) (*GetWorkspaceRequest, error) {
	req := &GetWorkspaceRequest{}
	vars := urlx.FormFromMap(mux.Vars(r))
	var varErr error
	req.Name = fmt.Sprintf("projects/%s/locations/%s/workspaces/%s", vars.Get("project"), vars.Get("location"), vars.Get("workspac"))
	if varErr != nil {
		return nil, varErr
	}
	return req, nil
}
func (*WorkspacesGorillaRequestDecoder) CreateWorkspace(ctx context.Context, r *http.Request) (*CreateWorkspaceRequest, error) {
	req := &CreateWorkspaceRequest{}
	if err := jsonx.NewDecoder(r.Body).Decode(&req.Workspace); err != nil {
		return nil, err
	}
	vars := urlx.FormFromMap(mux.Vars(r))
	var varErr error
	req.Parent = fmt.Sprintf("projects/%s/locations/%s", vars.Get("project"), vars.Get("location"))
	if varErr != nil {
		return nil, varErr
	}
	return req, nil
}
func (*WorkspacesGorillaRequestDecoder) UpdateWorkspace(ctx context.Context, r *http.Request) (*UpdateWorkspaceRequest, error) {
	req := &UpdateWorkspaceRequest{}
	if err := jsonx.NewDecoder(r.Body).Decode(&req.Workspace); err != nil {
		return nil, err
	}
	vars := urlx.FormFromMap(mux.Vars(r))
	var varErr error
	req.Name = fmt.Sprintf("projects/%s/locations/%s/Workspaces/%s", vars.Get("project"), vars.Get("location"), vars.Get("Workspac"))
	if varErr != nil {
		return nil, varErr
	}
	return req, nil
}
func (*WorkspacesGorillaRequestDecoder) DeleteWorkspace(ctx context.Context, r *http.Request) (*DeleteWorkspaceRequest, error) {
	req := &DeleteWorkspaceRequest{}
	vars := urlx.FormFromMap(mux.Vars(r))
	var varErr error
	req.Name = fmt.Sprintf("projects/%s/locations/%s/workspaces/%s", vars.Get("project"), vars.Get("location"), vars.Get("workspac"))
	if varErr != nil {
		return nil, varErr
	}
	return req, nil
}

type WorkspacesGorillaResponseEncoder struct {
}

func (*WorkspacesGorillaResponseEncoder) ListWorkspaces(ctx context.Context, w http.ResponseWriter, resp *ListWorkspacesResponse) error {
	w.Header().Set("Content-Type", "application/json; charset=utf-8")
	w.WriteHeader(http.StatusOK)
	data, err := protojson.MarshalOptions{}.Marshal(resp)
	if err != nil {
		return err
	}
	if _, err := w.Write(data); err != nil {
		return err
	}
	return nil
}
func (*WorkspacesGorillaResponseEncoder) GetWorkspace(ctx context.Context, w http.ResponseWriter, resp *Workspace) error {
	w.Header().Set("Content-Type", "application/json; charset=utf-8")
	w.WriteHeader(http.StatusOK)
	data, err := protojson.MarshalOptions{}.Marshal(resp)
	if err != nil {
		return err
	}
	if _, err := w.Write(data); err != nil {
		return err
	}
	return nil
}
func (*WorkspacesGorillaResponseEncoder) CreateWorkspace(ctx context.Context, w http.ResponseWriter, resp *Workspace) error {
	w.Header().Set("Content-Type", "application/json; charset=utf-8")
	w.WriteHeader(http.StatusOK)
	data, err := protojson.MarshalOptions{}.Marshal(resp)
	if err != nil {
		return err
	}
	if _, err := w.Write(data); err != nil {
		return err
	}
	return nil
}
func (*WorkspacesGorillaResponseEncoder) UpdateWorkspace(ctx context.Context, w http.ResponseWriter, resp *Workspace) error {
	w.Header().Set("Content-Type", "application/json; charset=utf-8")
	w.WriteHeader(http.StatusOK)
	data, err := protojson.MarshalOptions{}.Marshal(resp)
	if err != nil {
		return err
	}
	if _, err := w.Write(data); err != nil {
		return err
	}
	return nil
}
func (*WorkspacesGorillaResponseEncoder) DeleteWorkspace(ctx context.Context, w http.ResponseWriter, resp *emptypb.Empty) error {
	w.Header().Set("Content-Type", "application/json; charset=utf-8")
	w.WriteHeader(http.StatusOK)
	data, err := protojson.MarshalOptions{}.Marshal(resp)
	if err != nil {
		return err
	}
	if _, err := w.Write(data); err != nil {
		return err
	}
	return nil
}
